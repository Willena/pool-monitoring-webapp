(function(t){function e(e){for(var n,i,o=e[0],l=e[1],u=e[2],d=0,f=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&f.push(s[i][0]),s[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},s={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/pool-monitoring-webapp/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var c=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("85ec"),s=a.n(n);s.a},4678:function(t,e,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=r(t);return a(e)}function r(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}s.keys=function(){return Object.keys(n)},s.resolve=r,t.exports=s,s.id="4678"},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t._m(0),a("b-container",[a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("CurrentStatusCard",{attrs:{"current-status":t.currentStatus}})],1)],1),a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("ManualControlCard",{attrs:{"current-status":t.currentStatus}})],1)],1),a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("TimetableCard",{attrs:{"current-status":t.currentStatus}})],1)],1),a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("ConfigurationCard",{attrs:{"current-status":t.currentStatus}})],1)],1),a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("MaintainanceCard")],1)],1),a("b-row",{staticClass:"mb-3 mt-3"},[a("b-col",{attrs:{sm:"12"}},[a("FileExplorerCard")],1)],1)],1),a("b-modal",{ref:"modal_url",attrs:{id:"modal_id",title:"Define the pool to monitor","hide-footer":"","no-close-on-esc":!0,visible:t.modal_visible,"no-close-on-backdrop":!0}},[a("p",{staticClass:"my-4"},[a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Pool URL:","label-for":"url-pool"}},[a("div",[a("b-form-input",{attrs:{type:"text",id:"url-pool"},model:{value:t.pool_url,callback:function(e){t.pool_url=e},expression:"pool_url"}})],1)]),a("b-button",{attrs:{variant:"success",href:"?url="+t.pool_url}},[t._v("Go !")])],1)])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},[a("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[t._v("Swimming pool")]),a("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarsExampleDefault","aria-controls":"navbarsExampleDefault","aria-expanded":"false","aria-label":"Toggle navigation"}},[a("span",{staticClass:"navbar-toggler-icon"})]),a("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarsExampleDefault"}},[a("ul",{staticClass:"navbar-nav mr-auto"},[a("li",{staticClass:"nav-item active"},[a("a",{staticClass:"nav-link",attrs:{href:"#home"}},[t._v("Summary")])]),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#manual"}},[t._v("Manual control")])]),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#timetable"}},[t._v("Timetable")])]),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#config"}},[t._v("Configuration")])]),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#update"}},[t._v("Update")])]),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"/edit/"}},[t._v("File explorer")])])])])])}],i=(a("96cf"),a("1da1")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{title:"Swiming pool status","bg-variant":"primary","sub-title-text-variant":"white","text-variant":"white"}},[a("b-card-sub-title",{attrs:{"sub-title-text-variant":"white"}},[a("h6",[t._v(" "+t._s(t.deviceDate)+" - Uptime : "+t._s(t.deviceUptime))])]),a("b-card-body",[a("b-card-group",{attrs:{deck:""}},[a("b-card",{attrs:{"bg-variant":"white","text-variant":"dark",title:"Temperature"}},[a("b-card-body",{staticClass:"text-center"},[a("h1",[t._v(t._s(t.currentStatus.temperature))])])],1),a("b-card",{attrs:{"bg-variant":"white","text-variant":"dark"}},[a("b-card-title",[t._v(" Pump "),t.currentStatus.isManual?t._e():a("b-badge",{attrs:{pill:"",variant:"success"}},[t._v("Auto")]),t.currentStatus.isManual?a("b-badge",{attrs:{pill:"",variant:"warning"}},[t._v("Manual")]):t._e()],1),a("b-card-body",{staticClass:"text-center"},[t.currentStatus.isPumpActivated?t._e():a("h1",[t._v("OFF")]),t.currentStatus.isPumpActivated?a("h1",[t._v("ON")]):t._e(),a("span",[t._v(t._s(t.nextActionText))])])],1),a("b-card",{attrs:{"bg-variant":"white","text-variant":"dark",title:"PH level"}},[a("b-card-body",{staticClass:"text-center"},[a("h1",[t._v("N/A")])])],1),a("b-card",{attrs:{"bg-variant":"white","text-variant":"dark",title:"ORP/CL-/BR-"}},[a("b-card-body",{staticClass:"text-center"},[a("h1",[t._v("N/A")])])],1)],1)],1)],1)},l=[],u=(a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("b85c")),c=a("c1df"),d=a.n(c),f={name:"CurrentStatusCard",props:{currentStatus:Object},mounted:function(){this.deviceDate=d()(this.currentStatus.currentTimestamp,"X").toString()},data:function(){return{deviceDate:""+new Date}},computed:{deviceUptime:function(){var t=d.a.duration(this.currentStatus.uptime,"seconds");return(t.days()>0?t.days()+"d ":"")+(t.hours()>0?t.hours()+"h ":"")+(t.minutes()>0?t.minutes()+"m ":"")+(t.seconds()>0?t.seconds()+"s ":"")},nextActionText:function(){if(this.currentStatus.isManual)return this.currentStatus.isPumpActivated?"OFF "+d()().to(d()().add(this.currentStatus.remainingManualTime,"seconds")):"Manual ends "+d()().to(d()().add(this.currentStatus.remainingManualTime,"seconds"));var t,e=Object(u["a"])(this.currentStatus.currentTimetable);try{for(e.s();!(t=e.n()).done;){var a=t.value,n=a.on.split(":"),s=a.off.split(":"),r=d()().startOf("day").hours(parseInt(n[0])).minutes(parseInt(n[1])),i=d()().startOf("day").hours(parseInt(s[0])).minutes(parseInt(s[1]));if(this.currentStatus.isPumpActivated&&d()().isBetween(r,i))return"OFF "+d()().to(i);if(!this.currentStatus.isPumpActivated&&d()().isBefore(r))return"ON "+d()().to(r)}}catch(f){e.e(f)}finally{e.f()}if(this.currentStatus.currentTimetable.length>0){var o=this.currentStatus.currentTimetable[0],l=o.on.split(":"),c=d()().startOf("day").add(1,"day").hours(parseInt(l[0])).minutes(parseInt(l[1]));return"ON "+d()().to(c)}return""}}},m=f,b=a("2877"),p=Object(b["a"])(m,o,l,!1,null,"9dc221be",null),h=p.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{"bg-variant":"secondary","text-variant":"white"}},[a("b-card-title",[t._v(" Manual control "),t.currentStatus.isManual?a("b-badge",{attrs:{pill:"",variant:"danger"}},[t._v("In use !")]):t._e()],1),a("b-card-body",[a("p",[t._v("This card allows you to manually manage the pump, bypassing the timetable currently in place.")]),a("b-card",{attrs:{"bg-variant":"white","text-variant":"dark",title:""}},[a("b-card-text",[a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:t.showAdvencedOption,callback:function(e){t.showAdvencedOption=e},expression:"showAdvencedOption"}},[t._v(" Advanced options ")]),a("b-collapse",{attrs:{id:"collapse-3"},model:{value:t.showAdvencedOption,callback:function(e){t.showAdvencedOption=e},expression:"showAdvencedOption"}},[a("b-form-group",{staticClass:"mt-2",attrs:{"label-cols-sm":"2",label:"Duration :","label-for":"nested-country"}},[a("div",[a("b-form-spinbutton",{attrs:{id:"sb-vertical",min:"0",inline:""},model:{value:t.duration_days,callback:function(e){t.duration_days=e},expression:"duration_days"}}),a("span",{staticClass:"ml-2 mr-2"},[t._v("days")]),a("b-form-spinbutton",{attrs:{id:"sb-vertical",min:"0",inline:""},model:{value:t.duration_hours,callback:function(e){t.duration_hours=e},expression:"duration_hours"}}),a("span",{staticClass:"ml-2 mr-2"},[t._v("hours")]),a("b-form-spinbutton",{attrs:{id:"sb-vertical",min:"0",inline:""},model:{value:t.duration_minutes,callback:function(e){t.duration_minutes=e},expression:"duration_minutes"}}),a("span",{staticClass:"ml-2 mr-2"},[t._v("minutes")])],1)])],1)],1),a("b-card-footer",[t.currentStatus.isManual?a("b-button",{staticClass:"mr-2",attrs:{variant:"dark"},on:{click:t.reset}},[t._v("Reset to Auto mode")]):t._e(),a("b-button",{staticClass:"ml-2 mr-2",attrs:{variant:"info"},on:{click:t.setOn}},[t._v("Set ON "),t.showAdvencedOption?a("span",[t._v(t._s(t.selectedDuration))]):t._e()]),a("b-button",{staticClass:"ml-2",attrs:{variant:"danger"},on:{click:t.setOff}},[t._v("Set OFF "),t.showAdvencedOption?a("span",[t._v(t._s(t.selectedDuration))]):t._e()])],1)],1)],1)],1)},g=[],j=(a("3ca3"),a("841c"),a("ddb0"),a("2b3d"),a("bc3a")),y=a.n(j),x=new URLSearchParams(window.location.search),_=x.has("url")?"http://"+x.get("url")+"/":"http://example.com/",w="".concat(_),C=y.a.create({baseURL:w}),T="/api/manual",k={resetManualState:function(){return C.delete("".concat(T))},setManualState:function(t,e){return C.put("".concat(T),{duration:t,on:e})},setManualStateInfinite:function(t){return C.put("".concat(T),{on:t})}},S="/api/reboot",O={reboot:function(){return C.post("".concat(S))}},D="/api/status",F={get:function(){return C.delete("".concat(D))}},I="/api/update",A={postUpdate:function(t,e){var a=new FormData;if("firmware"===e&&a.append("firmware",t),"filesystem"===e)return a.append("filesystem",t),C.post("".concat(I),a,{headers:{"Content-Type":"multipart/form-data"}})},getUpdate:function(){}},M={update:A,status:F,reboot:O,manual:k},U={name:"ManualControlCard",props:{currentStatus:Object},data:function(){return{showAdvencedOption:!1,duration_minutes:0,duration_hours:0,duration_days:0,totalDuration:0}},methods:{setOn:function(){var t=this;this.showAdvencedOption&&this.totalDuration>0?M.manual.setManualState(this.totalDuration,!0).then((function(){return t.$emit("update-status")})):M.manual.setManualStateInfinite(!0).then((function(){return t.$emit("update-status")}))},setOff:function(){var t=this;this.showAdvencedOption&&this.totalDuration>0?M.manual.setManualState(this.totalDuration,!1).then((function(){return t.$emit("update-status")})):M.manual.setManualStateInfinite(!1).then((function(){return t.$emit("update-status")}))},reset:function(){var t=this;M.manual.resetManualState().then((function(){return t.$emit("update-status")}))}},computed:{selectedDuration:function(){var t=d.a.duration({minutes:this.duration_minutes,hours:this.duration_hours,days:this.duration_days});return t.days()>0||t.hours()>0||t.minutes()>0?"for "+(t.days()>0?t.days()+" days ":"")+(t.hours()>0?t.hours()+" hours ":"")+(t.minutes()>0?t.minutes()+" minutes ":""):""}}},$=U,z=Object(b["a"])($,v,g,!1,null,"1fd5dadd",null),E=z.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{title:"Time table","border-variant":"info"}},[a("b-card-text",[a("p",[t._v("This card shows the current timeline for manual and auto mode. It displays only moments when the pump will be ON")]),a("div",[a("timeline",{ref:"timeline",attrs:{items:t.items,groups:t.groups,options:t.options}})],1)])],1)},P=[],N={name:"TimetableCard",props:{currentStatus:Object},methods:{updateItems:function(){this.items.length=0;var t,e=Object(u["a"])(this.currentStatus.currentSeason.table);try{for(e.s();!(t=e.n()).done;){var a=t.value,n=d.a.duration(a.on),s=d.a.duration(a.off);this.items.push({id:"T"+this.items.length,content:"Auto range",start:d()().startOf("day").hours(n.hours()).minutes(n.minutes()),end:d()().startOf("day").hours(s.hours()).minutes(s.minutes()),type:"background"})}}catch(h){e.e(h)}finally{e.f()}var r,i=Object(u["a"])(this.currentStatus.currentTimetable);try{for(i.s();!(r=i.n()).done;){var o=r.value,l=o.on.split(":"),c=o.off.split(":"),f=d()().startOf("day").hours(parseInt(l[0])).minutes(parseInt(l[1])),m=d()().startOf("day").hours(parseInt(c[0])).minutes(parseInt(c[1]));this.items.push({id:this.items.length,group:0,start:f,end:m})}}catch(h){i.e(h)}finally{i.f()}if(this.currentStatus.isManual&&this.currentStatus.isPumpActivated){var b=d()(),p=d()().add(this.currentStatus.remainingManualTime,"seconds");this.items.push({id:this.items.length,group:1,start:b,end:p})}}},mounted:function(){this.updateItems()},data:function(){return{groups:[{id:0,content:"Auto"},{id:1,content:"Manual"}],items:[],options:{editable:!1,start:(new Date).setHours(0,0,0),end:(new Date).setHours(24,0,0),max:(new Date).setHours(24,0,0),min:(new Date).setHours(0,0,0),moveable:!1}}}},H=N,L=Object(b["a"])(H,R,P,!1,null,"4cd4e85d",null),J=L.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{title:"Configuration","border-variant":"dark"}},[a("b-row",[a("b-col",{attrs:{sm:"12"}},[t._v(" Select the configuration to edit: "),a("b-dropdown",{staticClass:"m-md-2",attrs:{id:"dropdown-1",text:t.currentFile.name}},t._l(t.configFiles,(function(e){return a("b-dropdown-item",{key:e.name,on:{click:function(e){return t.loadClickedConfig(e)}}},[t._v(" "+t._s(e.name)+" "),e.default?a("b-icon",{attrs:{icon:"star-fill"}}):t._e()],1)})),1),a("b-button",{staticClass:"ml-2",attrs:{variant:"info"},on:{click:t.setCurrentConfigAsDefault}},[t._v("Set default")]),a("b-button",{staticClass:"ml-2",attrs:{variant:"dark"},on:{click:t.addTemperatureRange}},[a("b-icon-plus")],1),a("b-button",{staticClass:"ml-2",attrs:{variant:"success"},on:{click:t.saveConfig}},[a("b-icon-file-earmark-arrow-down")],1),a("b-button",{staticClass:"ml-2 mr-2",attrs:{variant:"outline-info"},on:{click:t.downloadAsFile}},[a("b-icon-cloud-download")],1),a("b-form-file",{staticClass:"ml-4",staticStyle:{width:"15rem"},attrs:{placeholder:"Choose a file...","drop-placeholder":"Drop file here..."},model:{value:t.fileToUpload,callback:function(e){t.fileToUpload=e},expression:"fileToUpload"}}),a("b-button",{staticClass:"ml-2",attrs:{variant:"outline-info"},on:{click:t.uploadFile}},[a("b-icon-cloud-upload")],1)],1)],1),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},[a("b-tab",{attrs:{title:"Temperature configuration"}},[a("b-tabs",{attrs:{pills:"",card:"",vertical:""}},t._l(t.currentConfig.timetable,(function(e){return a("SingleTemperatureConfigurationTab",{key:e.id,attrs:{"current-status":t.currentStatus,"tab-data":e},on:{"remove-temperature-slot":t.removeTemperatureSlot}})})),1)],1),a("b-tab",{attrs:{title:"Season configuration"}},[a("b-tabs",{attrs:{pills:"",card:"",vertical:""}},t._l(t.currentConfig.whitehours,(function(e){return a("SingleSeasonConfigurationTab",{key:e.id,attrs:{"months-available":t.availableMonths,season:e,"current-status":t.currentStatus},on:{"remove-season-slot":t.removeSeasonSlot}})})),1)],1)],1)],1)],1)],1)],1)},W=[],q=(a("a434"),a("b0c0"),a("498a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-tab",{attrs:{title:t.computedTitle}},[a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:t.displayTable,callback:function(e){t.displayTable=e},expression:"displayTable"}},[t._v(" Use a custom table ")]),a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Start temperature: ","label-for":"start-temp"}},[a("b-input-group",[a("b-form-spinbutton",{attrs:{id:"start-temp",inline:"",min:"-20",max:"50"},model:{value:t.tabData.minT,callback:function(e){t.$set(t.tabData,"minT",e)},expression:"tabData.minT"}})],1)],1),a("b-form-group",{attrs:{"label-cols-sm":"2",label:"End temperature: ","label-for":"end-temp"}},[a("b-input-group",[a("b-form-spinbutton",{attrs:{id:"end-temp",inline:"",min:"-20",max:"50"},model:{value:t.tabData.maxT,callback:function(e){t.$set(t.tabData,"maxT",e)},expression:"tabData.maxT"}})],1)],1),a("b-collapse",{attrs:{visible:!t.displayTable,id:"collapse-3"}},[a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Splits: ","label-for":"time-splits"}},[a("b-input-group",[a("b-form-spinbutton",{attrs:{id:"time-splits",inline:"",min:"1",max:"24"},model:{value:t.tabData.splits,callback:function(e){t.$set(t.tabData,"splits",e)},expression:"tabData.splits"}})],1)],1),a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Duration :","label-for":"nested-state"}},[a("b-input-group",[a("b-form-input",{attrs:{id:"nested-state",type:"text",placeholder:"HH:mm"},on:{change:t.convertToSeconds},model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}}),a("b-input-group-append",[a("b-form-timepicker",{attrs:{"button-only":"",right:"",locale:"fr","aria-controls":"StartTimeInput"},model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}})],1)],1)],1)],1),a("b-collapse",{attrs:{visible:t.displayTable,id:"collapse-3"}},[a("timeline",{ref:"timeline",attrs:{items:t.items_table,groups:t.groups_table,options:t.options_table}})],1),a("b-card-footer",[a("div",{staticClass:"rigth"},[a("b-button",{attrs:{variant:"outline-danger"},on:{click:function(e){return t.$emit("remove-temperature-slot",t.tabData)}}},[a("b-icon-trash-fill")],1)],1)])],1)}),G=[],X={name:"SingleTemperatureConfigurationTab",props:{tabData:Object,currentStatus:Object},methods:{convertToSeconds:function(){return this.tabData.duration=d.a.duration(this.duration).asSeconds()},convertToTime:function(t){var e=d.a.duration(t,"seconds");return(e.hours()<10?"0":"")+e.hours()+":"+(e.minutes()<10?"0":"")+e.minutes()},findTableItemWithId:function(t){var e,a=Object(u["a"])(this.tabData.table);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.id===t)return n}}catch(s){a.e(s)}finally{a.f()}},createItem:function(t){t.end=(new Date).setTime(t.start.getTime()+36e5),t.content="";var e=d.a.duration(t.start.getTime(),"milliseconds"),a=d.a.duration(t.end,"milliseconds");this.tabData.table.push({id:t.id,on:this.convertToTime(e.asSeconds()),off:this.convertToTime(a.asSeconds())})},removeItem:function(t){for(var e=0;e<this.tabData.table.length;e++)if(t.id===this.tabData.table[e].id)return void this.tabData.table.splice(e,1)},updateItem:function(t){var e=this.findTableItemWithId(t.id),a=d()(t.start.getTime(),"x"),n=d()(t.end.getTime(),"x");e.on=a.hours()+":"+a.minutes(),e.off=n.hours()+":"+n.minutes()}},mounted:function(){this.items_table.length=0;var t,e=Object(u["a"])(this.currentStatus.currentSeason.table);try{for(e.s();!(t=e.n()).done;){var a=t.value,n=d.a.duration(a.on),s=d.a.duration(a.off);this.items_table.push({id:"T"+this.items_table.length,content:"Auto range",start:d()().startOf("day").hours(n.hours()).minutes(n.minutes()),end:d()().startOf("day").hours(s.hours()).minutes(s.minutes()),type:"background"})}}catch(b){e.e(b)}finally{e.f()}if(this.duration=this.convertToTime(this.tabData.duration),this.tabData.table&&this.tabData.table.length>0){this.displayTable=!0;var r,i=Object(u["a"])(this.tabData.table);try{for(i.s();!(r=i.n()).done;){var o=r.value,l=d.a.duration(o.on),c=d.a.duration(o.off),f=d()().startOf("day").hours(l.hours()).minutes(l.minutes()),m=d()().startOf("day").hours(c.hours()).minutes(c.minutes());o.id=this.items_table.length,this.items_table.push({id:this.items_table.length,group:0,start:f,end:m})}}catch(b){i.e(b)}finally{i.f()}}},computed:{computedTitle:function(){return this.tabData.minT+"° - "+this.tabData.maxT+"°"}},data:function(){return{displayTable:!1,duration:"",groups_table:[{id:0,content:"Auto"}],items_table:[],options_table:{editable:!0,start:(new Date).setHours(0,0,0),end:(new Date).setHours(24,0,0),max:(new Date).setHours(24,0,0),min:(new Date).setHours(0,0,0),moveable:!1,onAdd:function(t){return function(e,a){t.createItem(e),a(e)}}(this),onRemove:function(t){return function(e,a){t.removeItem(e),a(e)}}(this),onMove:function(t){return function(e,a){t.updateItem(e),a(e)}}(this)}}}},K=X,Q=Object(b["a"])(K,q,G,!1,null,"0dbb6206",null),V=Q.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-tab",{attrs:{title:t.season.name}},[a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Name : ","label-for":"season-name"}},[a("b-input-group",[a("b-form-input",{attrs:{id:"season-name",type:"text"},model:{value:t.season.name,callback:function(e){t.$set(t.season,"name",e)},expression:"season.name"}})],1)],1),a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Month :","label-for":"season-months"}},[a("b-input-group",[a("b-form-select",{attrs:{options:t.monthsAvailable,multiple:"","select-size":4},model:{value:t.season.months,callback:function(e){t.$set(t.season,"months",e)},expression:"season.months"}})],1)],1),a("timeline",{ref:"timeline",attrs:{items:t.items_table,groups:t.groups_table,options:t.options_table}}),a("b-card-footer",[a("div",{staticClass:"rigth"},[a("b-button",{attrs:{variant:"outline-danger"},on:{click:function(e){return t.$emit("remove-season-slot",t.season)}}},[a("b-icon-trash-fill")],1)],1)])],1)},Z=[],tt={name:"SingleSeasonConfigurationTab",props:{season:Object,currentStatus:Object,monthsAvailable:Array},methods:{convertToTime:function(t){var e=d.a.duration(t,"seconds");return(e.hours()<10?"0":"")+e.hours()+":"+(e.minutes()<10?"0":"")+e.minutes()},findTableItemWithId:function(t){var e,a=Object(u["a"])(this.season.table);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.id===t)return n}}catch(s){a.e(s)}finally{a.f()}},createItem:function(t){t.end=(new Date).setTime(t.start.getTime()+36e5),t.content="";var e=d.a.duration(t.start.getTime(),"milliseconds"),a=d.a.duration(t.end,"milliseconds");this.season.table.push({id:t.id,on:this.convertToTime(e.asSeconds()),off:this.convertToTime(a.asSeconds())})},removeItem:function(t){for(var e=0;e<this.season.table.length;e++)if(t.id===this.season.table[e].id)return void this.season.table.splice(e,1)},updateItem:function(t){var e=this.findTableItemWithId(t.id),a=d()(t.start.getTime(),"x"),n=d()(t.end.getTime(),"x");e.on=a.hours()+":"+a.minutes(),e.off=n.hours()+":"+n.minutes(),t.content=e.on+" - "+e.off}},mounted:function(){this.items_table.length=0,console.log("Seasons",this.season);var t,e=Object(u["a"])(this.season.table);try{for(e.s();!(t=e.n()).done;){var a=t.value,n=d.a.duration(a.on),s=d.a.duration(a.off),r=d()().startOf("day").hours(n.hours()).minutes(n.minutes()),i=d()().startOf("day").hours(s.hours()).minutes(s.minutes());a.id=this.items_table.length,this.items_table.push({id:this.items_table.length,group:0,content:a.on+" - "+a.off,start:r,end:i})}}catch(o){e.e(o)}finally{e.f()}},computed:{},data:function(){return{groups_table:[{id:0,content:"Season"}],items_table:[],options_table:{editable:!0,start:(new Date).setHours(0,0,0),end:(new Date).setHours(24,0,0),max:(new Date).setHours(24,0,0),min:(new Date).setHours(0,0,0),moveable:!1,onAdd:function(t){return function(e,a){t.createItem(e),a(e)}}(this),onRemove:function(t){return function(e,a){t.removeItem(e),a(e)}}(this),onMove:function(t){return function(e,a){t.updateItem(e),a(e)}}(this)}}}},et=tt,at=Object(b["a"])(et,Y,Z,!1,null,"3dcf9865",null),nt=at.exports,st=a("cc98"),rt=a.n(st),it={getDefault:function(){return C.get("/config/default.txt")},getFileList:function(){return C.get("/list?dir=/config/")},setDefault:function(t){var e=new FormData;return e.append("data",new Blob([t],{type:"application/json"},"/config/default.txt")),C.post("/edit",e,{headers:{"Content-Type":"multipart/form-data"}})},setConfig:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new FormData;return a?n.append("data",new Blob([e],{type:"application/json"},"/config/"+t)):n.append("data",e),C.post("/edit",n,{headers:{"Content-Type":"multipart/form-data"}})},getConfig:function(t){return C.get("/config/"+t)}},ot={name:"ConfigurationCard",components:{SingleTemperatureConfigurationTab:V,SingleSeasonConfigurationTab:nt},props:{currentStatus:Object},methods:{removeTemperatureSlot:function(){return function(t){console.log("this",this),console.log("slot",t);for(var e=0;e<this.currentConfig.timetable.length;e++)if(t.id===this.currentConfig.timetable[e].id)return void this.currentConfig.timetable.splice(e,1)}}(),removeSeasonSlot:function(){return function(t){console.log("this",this),console.log("slot",t)}}(),setCurrentConfigAsDefault:function(){this.saveConfig(),it.setDefault(this.currentFile.name)},loadClickedConfig:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,s,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=Object(u["a"])(e.configFiles),a.prev=1,n.s();case 3:if((s=n.n()).done){a.next=10;break}if(r=s.value,r.name!==t.target.innerText.trim()){a.next=8;break}return e.currentFile=r,a.abrupt("break",10);case 8:a.next=3;break;case 10:a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](1),n.e(a.t0);case 15:return a.prev=15,n.f(),a.finish(15);case 18:return a.next=20,it.getConfig(e.currentFile);case 20:return i=a.sent,a.t1=JSON,a.next=24,i.json();case 24:a.t2=a.sent,e.currentConfig=a.t1.parse.call(a.t1,a.t2);case 26:case"end":return a.stop()}}),a,null,[[1,12,15,18]])})))()},addTemperatureRange:function(){0===this.tabIndex?this.currentConfig.timetable.push({id:rt()(),splits:0,duration:0,minT:0,maxT:0,table:[]}):1===this.tabIndex&&this.currentConfig.whitehours.push({id:rt()(),name:"newSeason",months:[],table:[]})},saveConfig:function(){it.setConfig(this.currentFile.name,JSON.stringify(this.removeIdsFromConfig(this.currentConfig)))},removeIdsFromConfig:function(t){var e,a=JSON.parse(JSON.stringify(t)),n=Object(u["a"])(a.timetable);try{for(n.s();!(e=n.n()).done;){var s=e.value;delete s.id}}catch(f){n.e(f)}finally{n.f()}var r,i=Object(u["a"])(a.whitehours);try{for(i.s();!(r=i.n()).done;){var o=r.value;delete o.id;var l,c=Object(u["a"])(o.table);try{for(c.s();!(l=c.n()).done;){var d=l.value;delete d.id}}catch(f){c.e(f)}finally{c.f()}}}catch(f){i.e(f)}finally{i.f()}return a},downloadAsFile:function(){var t=JSON.stringify(this.removeIdsFromConfig(this.currentConfig)),e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",this.currentFile.name),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},uploadFile:function(){it.setConfig(this.fileToUpload[0].name,this.fileToUpload[0],!1)},getAvailableConfigFiles:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Fetching files"),e.next=3,it.getDefault();case 3:return a=e.sent.text,e.next=6,it.getFileList();case 6:n=e.sent.json,console.log(a),console.log(n),s=Object(u["a"])(n);try{for(s.s();!(r=s.n()).done;)i=r.value,t.configFiles.push({name:i.name,default:a===i.name})}catch(o){s.e(o)}finally{s.f()}case 11:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,s,r,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getAvailableConfigFiles();case 2:a=Object(u["a"])(t.configFiles),e.prev=3,a.s();case 5:if((n=a.n()).done){e.next=12;break}if(s=n.value,!s.default){e.next=10;break}return t.currentFile=t.configFiles[0],e.abrupt("break",12);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](3),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:r=Object(u["a"])(t.currentConfig.timetable);try{for(r.s();!(i=r.n()).done;)o=i.value,o.id=rt()()}catch(l){r.e(l)}finally{r.f()}case 22:case"end":return e.stop()}}),e,null,[[3,14,17,20]])})))()},data:function(){return{tabIndex:0,currentFile:"",fileToUpload:"",availableMonths:[{value:1,text:"January"},{value:2,text:"February"},{value:3,text:"March"},{value:4,text:"April"},{value:5,text:"May"},{value:6,text:"June"},{value:7,text:"July"},{value:8,text:"August"},{value:9,text:"September"},{value:10,text:"October"},{value:11,text:"November"},{value:12,text:"December"}],configFiles:[{default:!0,name:"config.json"},{default:!1,name:"config2.json"}],currentConfig:{timetable:[{minT:-10,maxT:5,table:[{on:"5:30",off:"7:30"}]},{minT:5,maxT:10,splits:1,duration:7200},{minT:10,maxT:12,splits:1,duration:14400},{minT:12,maxT:16,splits:2,duration:21600},{minT:16,maxT:24,splits:2,duration:28800},{minT:24,maxT:27,splits:3,duration:43200},{minT:27,maxT:30,splits:4,duration:72e3},{minT:30,maxT:50,splits:1,duration:86400}],whitehours:[{name:"summer",months:[4,5,6,7,8,9],table:[{on:"5:30",off:"22:30"}]},{name:"winter",months:[10,11,12,1,2,3],table:[{on:"7:30",off:"16:30"}]}]}}}},lt=ot,ut=Object(b["a"])(lt,B,W,!1,null,"8a680550",null),ct=ut.exports,dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{title:"Maintainance","border-variant":"danger"}},[a("b-card-text",[a("p",[t._v("Use this card to send update over the air.")]),a("b-form",{attrs:{inline:""}},[a("b-form-group",{attrs:{"label-cols-sm":"2",label:"Firmware :","label-for":"file-firmware"}},[a("b-input-group",[a("b-form-file",{ref:"file-input-firmware",staticClass:"mb-2 mt-2",staticStyle:{width:"40rem"},attrs:{id:"file-firmware"},model:{value:t.fileFirmware,callback:function(e){t.fileFirmware=e},expression:"fileFirmware"}})],1)],1),a("b-button",{ref:"btn-firm",staticClass:"ml-2",attrs:{variant:"warning"},on:{click:t.firmwareUpdate}},[a("b-icon-box-arrow-in-right"),t._v(" Update Firmware ! ")],1)],1),a("b-form",{attrs:{inline:""}},[a("b-form-group",{attrs:{"label-cols-sm":"2",label:"File system :","label-for":"file-s"}},[a("b-input-group",[a("b-form-file",{ref:"file-input-fs",staticClass:"mb-2 mt-2",staticStyle:{width:"40rem"},attrs:{id:"file-firmware"},model:{value:t.fileFilesystem,callback:function(e){t.fileFilesystem=e},expression:"fileFilesystem"}})],1)],1),a("b-button",{ref:"btn-fs",staticClass:"ml-2",attrs:{variant:"warning"},on:{click:t.fsUpdate}},[a("b-icon-box-arrow-in-right"),t._v(" Update filsystem! ")],1)],1),a("b-button",{staticClass:"mt-3 ml-2",attrs:{variant:"danger"},on:{click:t.reboot}},[a("b-icon-bootstrap-reboot"),t._v(" Reboot ESP ")],1)],1)],1)},ft=[],mt={name:"MaintainanceCard",props:{},methods:{fsUpdate:function(){console.log(this),this.$refs["btn-fs"].disabled=!0,this.$refs["btn-firm"].disabled=!0,A.postUpdate(this.$ref["file-input-firmware"].files,"firmware")},firmwareUpdate:function(){console.log(this),this.$refs["btn-fs"].disabled=!0,this.$refs["btn-firm"].disabled=!0,A.postUpdate(this.$ref["file-input-fs"].files,"filesystem")},reboot:function(){O.reboot()}},data:function(){return{fileFirmware:null,fileFilesystem:null}}},bt=mt,pt=Object(b["a"])(bt,dt,ft,!1,null,"2e7b6e0e",null),ht=pt.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{title:"File Explorer","border-variant":"warning"}},[a("b-card-text",[t._v(" Some quick example text to build on the "),a("em",[t._v("card title")]),t._v(" and make up the bulk of the card's content. ")])],1)},gt=[],jt={name:"FileExplorerCard",props:{}},yt=jt,xt=Object(b["a"])(yt,vt,gt,!1,null,"3af22ca7",null),_t=xt.exports,wt={name:"App",components:{FileExplorerCard:_t,MaintainanceCard:ht,ConfigurationCard:ct,TimetableCard:J,ManualControlCard:E,CurrentStatusCard:h},methods:{collectStatus:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M.status.get();case 2:a=e.sent,n=a.json,t.currentStatus=n;case 5:case"end":return e.stop()}}),e)})))()}},mounted:function(){console.log(C.defaults.baseURL),"http://example.com/"===C.defaults.baseURL&&(this.modal_visible=!0)},created:function(){setInterval(this.collectStatus.bind(this),3e4),this.collectStatus()},data:function(){return{pool_url:"",modal_visible:!1,currentStatus:{isManual:!0,remainingManualTime:4e3,currentTimestamp:1590066161,temperature:23.125,isPumpActivated:!0,phLevel:0,OrpClBrLevel:0,version:"May 21 2020",uptime:948,currentTimetable:[{on:"7:45",off:"11:45"},{on:"16:15",off:"20:15"}],currentSeason:{name:"summer",months:[4,5,6,7,8,9],table:[{on:"7:30",off:"21:30"}]}}}}},Ct=wt,Tt=(a("034f"),Object(b["a"])(Ct,s,r,!1,null,null,null)),kt=Tt.exports,St=a("5f5b"),Ot=a("b1e0"),Dt=(a("f9e3"),a("2dd8"),a("a18d"),a("1615"),a("9b29"));n["default"].component("timeline",Dt["Timeline"]),n["default"].config.productionTip=!1,n["default"].use(St["a"]),n["default"].use(Ot["a"]),new n["default"]({render:function(t){return t(kt)}}).$mount("#app")},"85ec":function(t,e,a){}});
//# sourceMappingURL=app.835a61b5.js.map